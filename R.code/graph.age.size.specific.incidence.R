load("~/Desktop/Cancer/data/breast.Rdata")

matplot(1975:2002,10^6*size.rate3[3:30,1,],bty="l",ylab="rate per 100,000",las=1,xlab="year",cex=0.75)
matplot(1975:2002,10^6*size.rate3[3:30,2,],bty="l",ylab="rate per 100,000",las=1,xlab="year",cex=0.75)
matplot(1975:2002,10^6*size.rate3[3:30,3,],bty="l",ylab="rate per 100,000",las=1,xlab="year",cex=0.75)

ymax <- 1800
pdf("~/Dropbox/talks/figures/age_size_incidence_rates.pdf", height=3.5, width=11, paper="special")
par (mfrow=c(1,4),mgp=c(2.75,1,0)*0.55,mar=c(1.6,1.5,0.5,1.0)*1.6,omi=c(0.2,0.5,0.4,0), tcl=-0.25,bg="white",cex=0.75,cex.main=0.75)
matplot(1975:2002,10^6*size.rate3[3:30,1,],bty="l",ylab="",las=1,xlab="year",cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,10^6*size.rate3[3:30,2,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,10^6*size.rate3[3:30,3,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,10^6*size.rate3[3:30,4,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
mtext("incidence rate per 100,000",side=2,line=0.5,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("age 40-49",side=3,line=-1,outer=TRUE,at=1/8,cex=0.75)
mtext("age 50-59",side=3,line=-1,outer=TRUE,at=3/8,cex=0.75)
mtext("age 60-69",side=3,line=-1,outer=TRUE,at=5/8,cex=0.75)
mtext("age 70-79",side=3,line=-1,outer=TRUE,at=7/8,cex=0.75)
dev.off()

ymax <- 1800
pdf("~/Dropbox/talks/figures/age_size_incidence_rates2.pdf", height=3.5, width=11, paper="special")
par (mfrow=c(1,4),mgp=c(2.75,1,0)*0.55,mar=c(1.6,1.5,0.5,1.0)*1.6,omi=c(0.2,0.5,0.4,0), tcl=-0.25,bg="white",cex=0.75,cex.main=0.75)
matplot(c(1975,2002),10^6*size.rate3[c(3,30),1,],bty="l",ylab="",las=1,xlab="year",cex=0.75,ylim=c(0,ymax),type="b",lty=1)
matplot(c(1975,2002),10^6*size.rate3[c(3,30),2,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax),type="b",lty=1)
matplot(c(1975,2002),10^6*size.rate3[c(3,30),3,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax),type="b",lty=1)
matplot(c(1975,2002),10^6*size.rate3[c(3,30),4,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax),type="b",lty=1)
mtext("incidence rate per 100,000",side=2,line=0.5,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("age 40-49",side=3,line=-1,outer=TRUE,at=1/8,cex=0.75)
mtext("age 50-59",side=3,line=-1,outer=TRUE,at=3/8,cex=0.75)
mtext("age 60-69",side=3,line=-1,outer=TRUE,at=5/8,cex=0.75)
mtext("age 70-79",side=3,line=-1,outer=TRUE,at=7/8,cex=0.75)
dev.off()

ymax <- 2000
pdf("~/Dropbox/talks/figures/age_size_counts.pdf", height=3.5, width=11, paper="special")
par (mfrow=c(1,4),mgp=c(2.75,1,0)*0.55,mar=c(1.6,1.5,0.5,1.0)*1.6,omi=c(0.2,0.5,0.4,0), tcl=-0.25,bg="white",cex=0.75,cex.main=0.75)
matplot(1975:2002,size.counts3[3:30,1,],bty="l",ylab="",las=1,xlab="year",cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,size.counts3[3:30,2,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,size.counts3[3:30,3,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
matplot(1975:2002,size.counts3[3:30,4,],bty="l",ylab=NA,las=1,xlab=NA,cex=0.75,ylim=c(0,ymax))
mtext("counts",side=2,line=0.5,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("year",side=1,line=-1,outer=TRUE,at=1/2,cex=0.75)
mtext("age 40-49",side=3,line=-1,outer=TRUE,at=1/8,cex=0.75)
mtext("age 50-59",side=3,line=-1,outer=TRUE,at=3/8,cex=0.75)
mtext("age 60-69",side=3,line=-1,outer=TRUE,at=5/8,cex=0.75)
mtext("age 70-79",side=3,line=-1,outer=TRUE,at=7/8,cex=0.75)
dev.off()


   counts[as.character(year.list[y]),1,1]/sum(counts[as.character(year.list[y]),1,])
   counts[as.character(year.list[y]),2,1]/sum(counts[as.character(year.list[y]),2,])
   counts[as.character(year.list[y]),3,1]/sum(counts[as.character(year.list[y]),3,])
   counts[as.character(year.list[y]),4,1]/sum(counts[as.character(year.list[y]),4,])
   counts[as.character(year.list[y]),5,1]/sum(counts[as.character(year.list[y]),5,])
